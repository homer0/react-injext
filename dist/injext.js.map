{"version":3,"file":"injext.js","sources":["../src/container.js","../src/index.js","../src/decorator.js","../src/hoc.jsx"],"sourcesContent":["class ReactInjextContainer {\n  constructor(containerName = 'reactInjext') {\n    this.containerName = containerName;\n    this._dependencies = [];\n  }\n\n  get(...dependencies) {\n    return dependencies.map((dependency) => this._getInstance(dependency));\n  }\n\n  getDictionary(...dependencies) {\n    const result = {};\n    dependencies.forEach((dependency) => {\n      const info = this._getInstance(dependency, true);\n      result[info.name] = info.instance;\n    });\n\n    return result;\n  }\n\n  asSingleton(dependency) {\n    return this._asDependency(dependency);\n  }\n\n  asTransient(dependency) {\n    return this._asDependency(dependency, {\n      type: 'transient',\n    });\n  }\n\n  _asDependency(dependency, options = {}) {\n    return Object.assign(\n      {\n        class: dependency,\n        injext: this.containerName,\n        type: 'singleton',\n      },\n      options,\n    );\n  }\n\n  _getInstance(dependency, named = false) {\n    const dependencyInfo = this._isDependency(dependency) ?\n      dependency :\n      this._asDependency(dependency);\n    const isSingleton = dependencyInfo.type === 'singleton';\n    let instance;\n    if (isSingleton && this._dependencies[dependencyInfo.class]) {\n      instance = this._dependencies[dependencyInfo.class];\n    } else {\n      instance = this._buildInstance(dependencyInfo.class);\n      if (isSingleton) {\n        this._dependencies[dependencyInfo.class] = instance;\n      }\n    }\n\n    return named ?\n      {\n        name: this._getDependencyName(dependencyInfo),\n        instance,\n      } :\n      instance;\n  }\n\n  _isDependency(dependency) {\n    return dependency.injext === this.containerName;\n  }\n\n  _buildInstance(ClassForInstance) {\n    const dependencies = ClassForInstance.inject || [];\n    const dependenciesList = dependencies\n    .map((dependency) => this._getInstance(dependency));\n    return new ClassForInstance(...dependenciesList);\n  }\n\n  _getDependencyName(dependency) {\n    const { name } = dependency.class;\n    const firstLetter = name.substr(0, 1).toLowerCase();\n    const rest = name.substr(1);\n    return `${firstLetter}${rest}`;\n  }\n}\n\nexport default ReactInjextContainer;\nexport const reactInjextContainer = new ReactInjextContainer();\n","import ReactInjextContainer, { reactInjextContainer } from './container';\nimport reactInjextDecorator from './decorator';\nimport reactInjextHOC from './hoc';\n\nexport default reactInjextHOC;\nexport const container = reactInjextContainer;\nexport const inject = reactInjextDecorator;\nexport const InjextContainer = ReactInjextContainer;\n","const reactInjextDecorator = (...dependencies) => (target) => {\n  // eslint-disable-next-line no-param-reassign\n  target.inject = dependencies;\n};\n\nexport default reactInjextDecorator;\n","import React from 'react';\nimport { reactInjextContainer } from './container';\n\nconst reactInjextHOC = (dependencies, container = null) =>\n  (Component) =>\n    (props) => {\n      const newContainer = container || reactInjextContainer;\n      const newProps = Object.assign(\n        {},\n        props,\n        {\n          dependencies: newContainer.get(...dependencies),\n        },\n      );\n\n      return (<Component {...newProps} />);\n    };\n\nexport default reactInjextHOC;\n"],"names":["ReactInjextContainer","containerName","_dependencies","dependencies","map","dependency","_this","_getInstance","result","forEach","info","_this2","name","instance","this","_asDependency","options","Object","assign","named","dependencyInfo","_isDependency","isSingleton","type","class","_buildInstance","_getDependencyName","injext","ClassForInstance","dependenciesList","inject","_this3","substr","toLowerCase","reactInjextContainer","container","target","InjextContainer","Component","props","newContainer","newProps","get","React"],"mappings":"0tBAAMA,8BACQC,yDAAgB,6BACrBA,cAAgBA,OAChBC,2FAGAC,gDACEA,EAAaC,IAAI,SAACC,UAAeC,EAAKC,aAAaF,4DAIpDG,wBADSL,kDAEFM,QAAQ,SAACJ,OACdK,EAAOC,EAAKJ,aAAaF,GAAY,KACpCK,EAAKE,MAAQF,EAAKG,WAGpBL,sCAGGH,UACHS,KAAKC,cAAcV,uCAGhBA,UACHS,KAAKC,cAAcV,QAClB,oDAIIA,OAAYW,mEACjBC,OAAOC,cAEHb,SACCS,KAAKb,mBACP,aAERe,wCAISX,OAAYc,0DACjBC,EAAiBN,KAAKO,cAAchB,GACxCA,EACAS,KAAKC,cAAcV,GACfiB,EAAsC,cAAxBF,EAAeG,KAC/BV,gBACAS,GAAeR,KAAKZ,cAAckB,EAAeI,SACxCV,KAAKZ,cAAckB,EAAeI,UAElCV,KAAKW,eAAeL,EAAeI,OAC1CF,SACGpB,cAAckB,EAAeI,OAASX,IAIxCM,QAEGL,KAAKY,mBAAmBN,eAGhCP,wCAGUR,UACLA,EAAWsB,SAAWb,KAAKb,qDAGrB2B,cAEPC,GADeD,EAAiBE,YAErC1B,IAAI,SAACC,UAAe0B,EAAKxB,aAAaF,8CAC5BuB,kBAAoBC,iDAGdxB,OACTO,EAASP,EAAWmB,MAApBZ,cACYA,EAAKoB,OAAO,EAAG,GAAGC,cACzBrB,EAAKoB,OAAO,YAMhBE,EAAuB,IAAIlC,EC/E3BmC,EAAYD,EACZJ,ECNgB,sCAAI3B,gDAAiB,SAACiC,KAE1CN,OAAS3B,IDKLkC,EAAkBrC,YEJR,SAACG,OAAcgC,yDAAY,YAChD,SAACG,UACC,SAACC,OACOC,EAAeL,GAAaD,EAC5BO,EAAWxB,OAAOC,UAEtBqB,gBAEgBC,EAAaE,cAAOvC,aAI9BwC,gBAACL,EAAcG"}